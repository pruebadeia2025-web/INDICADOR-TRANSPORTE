<!doctype html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<title>INDICADORES DE TRANSPORTE</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="description" content="Portal de dashboards e indicadores de transporte, CISS y clientes - Power BI" />
	<meta name="keywords" content="indicadores, transporte, dashboards, power bi, ciss, clientes, analytics" />
	<meta name="author" content="RANSA" />
  
	<!-- Favicon -->
	<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23009A3F' rx='15'/><g fill='white'><rect x='20' y='40' width='25' height='15' rx='2'/><rect x='50' y='45' width='20' height='10' rx='2'/><circle cx='30' cy='65' r='5'/><circle cx='60' cy='65' r='5'/><rect x='20' y='55' width='50' height='2'/></g></svg>">
	<link rel="alternate icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23009A3F' rx='15'/><g fill='white'><rect x='20' y='40' width='25' height='15' rx='2'/><rect x='50' y='45' width='20' height='10' rx='2'/><circle cx='30' cy='65' r='5'/><circle cx='60' cy='65' r='5'/><rect x='20' y='55' width='50' height='2'/></g></svg>">
	<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23009A3F' rx='15'/><g fill='white'><rect x='20' y='40' width='25' height='15' rx='2'/><rect x='50' y='45' width='20' height='10' rx='2'/><circle cx='30' cy='65' r='5'/><circle cx='60' cy='65' r='5'/><rect x='20' y='55' width='50' height='2'/></g></svg>">
  
	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="website" />
	<meta property="og:url" content="" />
	<meta property="og:title" content="INDICADORES DE TRANSPORTE" />
	<meta property="og:description" content="Portal de dashboards e indicadores de transporte, CISS y clientes" />
  
	<!-- Twitter -->
	<meta property="twitter:card" content="summary_large_image" />
	<meta property="twitter:url" content="" />
	<meta property="twitter:title" content="INDICADORES DE TRANSPORTE" />
	<meta property="twitter:description" content="Portal de dashboards e indicadores de transporte, CISS y clientes" />
	<style>
		:root{--bg:#0b1220;--card:#0f172a;--txt:#e5e7eb;--muted:#9D9D9C;--line:#1e293b;--pri:#009A3F;--secondary:#F39200;--accent:#00652A}
		*{box-sizing:border-box}
		body{margin:0;font-family:"Verdana",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--txt)}
		header{display:flex;gap:12px;align-items:center;flex-wrap:wrap;padding:14px 16px;border-bottom:1px solid var(--line)}
		h1{margin:0;font-size:18px;font-weight:800;font-family:"Verdana",sans-serif}
		.muted{color:var(--muted);font-size:12px}
		.tabs{display:flex;gap:8px;flex-wrap:wrap;margin-left:auto}
		.tab{background:#0a1222;color:var(--txt);border:1px solid var(--line);border-radius:999px;padding:8px 12px;cursor:pointer;font-weight:700;transition:all 0.2s ease;font-family:"Verdana",sans-serif}
		.tab:hover{background:var(--accent);color:#ffffff;border-color:var(--accent)}
		.tab:focus{outline:2px solid var(--pri);outline-offset:2px}
		.tab.active{background:var(--pri);color:#ffffff;border-color:transparent}
		main{max-width:1200px;margin:0 auto;padding:16px;display:grid;gap:16px}
		.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:12px}
		.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
		select,button{background:#0a1222;color:var(--txt);border:1px solid var(--line);border-radius:10px;padding:8px 10px;font-family:"Verdana",sans-serif}
		button{cursor:pointer;font-weight:700;transition:all 0.2s ease}
		button:hover{background:var(--secondary);color:#ffffff;border-color:var(--secondary)}
		button:focus{outline:2px solid var(--pri);outline-offset:2px}
		button:disabled{opacity:0.5;cursor:not-allowed}
		select:focus{outline:2px solid var(--pri);outline-offset:2px}
		.pill{background:#10223a;border:1px solid var(--line);padding:4px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
		.title{margin:8px 0 10px;font-size:16px;font-weight:800}
		.iframe-wrap{position:relative;width:100%;aspect-ratio:16/9;background:#070c18;border:1px solid #0b1324;border-radius:12px;overflow:hidden}
		@supports not (aspect-ratio:16/9){.iframe-wrap{padding-top:56.25%}.iframe-wrap iframe{position:absolute;inset:0;height:100%}}
		iframe{width:100%;height:100%;border:0}
		.hint{font-size:12px;color:var(--muted);margin-top:8px}
		.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
		.error{color:#ef4444;background:#2d1b1b;border:1px solid #7f1d1d;padding:8px 12px;border-radius:6px;margin:8px 0;font-size:12px}
		.loading{text-align:center;padding:20px;color:var(--muted)}
		@media (max-width: 768px) {
			header{flex-direction:column;align-items:center;text-align:center}
			h1{font-size:16px;margin-bottom:12px}
			.tabs{margin-left:0;margin-top:8px;width:100%}
			.tab{flex:1;text-align:center;font-size:11px;padding:6px 8px}
			.controls{flex-direction:column;align-items:stretch}
			.row{flex-direction:column;align-items:stretch}
		}
	</style>
</head>
<body>
<header>
	<h1>
	<span style="color:#009A3F;font-weight:900;letter-spacing:2px;font-size:18px;vertical-align:middle;">RANSA</span>
	<span style="color:#009A3F;font-weight:900;font-size:18px;vertical-align:middle;"> - </span>
	<span style="color:#009A3F;font-weight:900;letter-spacing:2px;font-size:18px;vertical-align:middle;">INDICADORES DE TRANSPORTE</span>
	</h1>
	<div class="tabs" role="tablist">
	<button class="tab active" data-seg="general" role="tab" aria-selected="true" aria-controls="controls-general">GENERAL DE TRANSPORTE</button>
		<button class="tab" data-seg="control" role="tab" aria-selected="false" aria-controls="controls-control">CONTROL DE RENTABILIDAD</button>
		<button class="tab" data-seg="clientes" role="tab" aria-selected="false" aria-controls="controls-clientes">CLIENTES</button>
		<button class="tab" data-seg="ciss" role="tab" aria-selected="false" aria-controls="controls-ciss">CISS</button>
	</div>
</header>

<main>
	<section class="card">
		<div class="row">
			<span class="pill" id="pillSeg">Segmento: —</span>
			<span class="pill" id="pillSel">Selección: —</span>
			<button id="copy" title="Copiar enlace actual" aria-label="Copiar enlace actual al portapapeles">Copiar enlace actual</button>
		</div>

		<div id="error-container"></div>

		<div class="controls" id="controls-general" role="tabpanel" aria-labelledby="tab-general">
			<label for="selGeneral" class="muted">Reporte:</label>
			<select id="selGeneral" aria-label="Seleccionar reporte general"></select>
		</div>

		<div class="controls" id="controls-control" style="display:none" role="tabpanel" aria-labelledby="tab-control">
			<label class="muted">Dashboard:</label>
			<select id="selControl" aria-label="Seleccionar dashboard de control"></select>
		</div>

		<div class="controls" id="controls-clientes" style="display:none" role="tabpanel" aria-labelledby="tab-clientes">
			<label for="selCliente" class="muted">Cliente:</label>
			<select id="selCliente" aria-label="Seleccionar cliente"></select>
			<label for="selRepCliente" class="muted">Reporte:</label>
			<select id="selRepCliente" aria-label="Seleccionar reporte del cliente"></select>
		</div>

		<div class="controls" id="controls-ciss" style="display:none" role="tabpanel" aria-labelledby="tab-ciss">
			<label for="selCiss" class="muted">Reporte:</label>
			<select id="selCiss" aria-label="Seleccionar reporte CISS"></select>
		</div>

		<h2 class="title" id="titulo">—</h2>
		<div class="iframe-wrap">
			<div id="loading" class="loading" style="display:none">Cargando dashboard...</div>
			<iframe id="frame" title="Power BI Report" src="about:blank" allowfullscreen sandbox="allow-scripts allow-same-origin allow-popups allow-forms"></iframe>
		</div>
		<p class="hint">
			Portal de Indicadores de Transporte - Grupo Ransa<br>
			Dashboards integrados desde Power BI Service
		</p>
	</section>
</main>

<script>
const DATA = {
  general: [
    { id: "ventas", nombre: "Ventas", url: "https://app.powerbi.com/view?r=eyJrIjoiNDk1OGI4NjgtZmQ0OS00MzU3LTllZjItMjk0NWNiNDIwYzE5IiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" },
    { id: "general_transporte", nombre: "General Transporte", url: "https://app.powerbi.com/view?r=eyJrIjoiOTk1MGRjYTMtNWIxMC00MjY5LWI2NTYtMDViZjdhYWFiOTUyIiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" }
  ],
  control: [
    { id: "control_rentabilidad", nombre: "Control de Rentabilidad", url: "https://app.powerbi.com/view?r=eyJrIjoiNTdjZTE0NTUtMTQwNy00MDY1LWIzZGQtNDNjNTgzNjhlYWFjIiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" }
  ],
  ciss: [
    { id: "pqrs", nombre: "PQRS", url: "https://app.powerbi.com/view?r=eyJrIjoiYzczNjZhNTAtZjhiOS00N2FmLWIyZGYtYzRhY2Y0ZGZkNGZkIiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" },
    { id: "ciss_novedades", nombre: "CISS Novedades", "https://app.powerbi.com/view?r=eyJrIjoiNTdlYzAwZGEtMzY5ZC00NjEzLWExMzgtNGFhMjg2YTJmODE2IiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" },
    { id: "incidencias", nombre: "Incidencias", url: "https://app.powerbi.com/view?r=eyJrIjoiNmRhNGMyM2QtODhhOS00MjFjLWFiM2YtMjUyOGYyNGJmMzVjIiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" }
  ],
  clientes: [
    {
      id: "frisby", nombre: "FRISBY",
      reportes: [
        { id: "dashboard", nombre: "Dashboard Principal", url: "https://app.powerbi.com/view?r=eyJrIjoiYWEzOGMwNzctNzdlNi00N2Y3LWEzYzQtZDNhZjk3MzA1YTc4IiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" }
      ]
    },
    {
      id: "congelagro", nombre: "CONGELAGRO",
      reportes: [
        { id: "dashboard", nombre: "Dashboard Principal", url: "https://app.powerbi.com/view?r=eyJrIjoiOTFjYTJiMGItZThjMC00MGU2LWJlYzktYWFhMmFmYzVjZmI1IiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" }
      ]
    },
    {
      id: "cencosud", nombre: "CENCOSUD",
      reportes: [
        { id: "dashboard", nombre: "Dashboard Principal", url: "https://app.powerbi.com/view?r=eyJrIjoiZGM4MTQ0NzgtZGFmMi00MTRhLTljZDAtZDE2OTFlYTZmOWQ3IiwidCI6IjMyZTAxNzYzLTQxZTItNDA5My1hZWQ2LTVhZjFmOWMzNzk2NSJ9" }
      ]
    }
  ]
};

let estado = { seg: 'general', rep: null, cliente: null };
let isInitialized = false;

function poblarSelect(select, items, getVal = x => x?.id, getTxt = x => x?.nombre) {
  select.innerHTML = '';
  for (const item of items) {
    const opt = document.createElement('option');
    opt.value = getVal(item);
    opt.textContent = getTxt(item);
    select.appendChild(opt);
  }
}

function activarSeg(seg) {
  estado.seg = seg;
  document.querySelectorAll('.tab').forEach(t => {
    t.classList.toggle('active', t.dataset.seg === seg);
    t.setAttribute('aria-selected', t.dataset.seg === seg);
  });
  document.getElementById('controls-general').style.display = seg === 'general' ? '' : 'none';
  document.getElementById('controls-control').style.display = seg === 'control' ? '' : 'none';
  document.getElementById('controls-clientes').style.display = seg === 'clientes' ? '' : 'none';
  document.getElementById('controls-ciss').style.display = seg === 'ciss' ? '' : 'none';
  cargarActual();
}

function cargarActual() {
  let url = 'about:blank', titulo = '—', selTxt = '—';
  if (estado.seg === 'general') {
    const r = DATA.general.find(x => x.id === estado.rep) || DATA.general[0];
    url = r.url; titulo = `INDICADOR GENERAL DE TRANSPORTE — ${r.nombre}`; selTxt = r.nombre;
  } else if (estado.seg === 'control') {
    const r = DATA.control.find(x => x.id === estado.rep) || DATA.control[0];
    url = r.url; titulo = `CONTROL DE RENTABILIDAD — ${r.nombre}`; selTxt = r.nombre;
  } else if (estado.seg === 'ciss') {
    const r = DATA.ciss.find(x => x.id === estado.rep) || DATA.ciss[0];
    url = r.url; titulo = `CISS — ${r.nombre}`; selTxt = r.nombre;
  } else {
    const c = DATA.clientes.find(x => x.id === estado.cliente) || DATA.clientes[0];
    const r = c.reportes.find(x => x.id === estado.rep) || c.reportes[0];
    url = r.url; titulo = `CLIENTES — ${c.nombre} / ${r.nombre}`; selTxt = `${c.nombre} • ${r.nombre}`;
  }
  document.getElementById('frame').src = url;
  document.getElementById('titulo').textContent = titulo;
  document.getElementById('pillSeg').textContent = `Segmento: ${estado.seg.toUpperCase()}`;
  document.getElementById('pillSel').textContent = `Selección: ${selTxt}`;
}

document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.tab').forEach(btn => {
    btn.addEventListener('click', () => {
      estado.rep = null;
      activarSeg(btn.dataset.seg);
    });
  });
  document.getElementById('selGeneral').addEventListener('change', function() {
    estado.rep = this.value; cargarActual();
  });
  document.getElementById('selControl').addEventListener('change', function() {
    estado.rep = this.value; cargarActual();
  });
  document.getElementById('selCiss').addEventListener('change', function() {
    estado.rep = this.value; cargarActual();
  });
  document.getElementById('selCliente').addEventListener('change', function() {
    estado.cliente = this.value;
    const cli = DATA.clientes.find(c => c.id === estado.cliente);
    poblarSelect(document.getElementById('selRepCliente'), cli.reportes);
    estado.rep = cli.reportes[0].id;
    document.getElementById('selRepCliente').value = estado.rep;
    cargarActual();
  });
  document.getElementById('selRepCliente').addEventListener('change', function() {
    estado.rep = this.value; cargarActual();
  });
  document.getElementById('copy').addEventListener('click', function() {
    navigator.clipboard.writeText(location.href);
    this.textContent = '¡Enlace copiado!';
    setTimeout(() => { this.textContent = 'Copiar enlace actual'; }, 1500);
  });

  poblarSelect(document.getElementById('selGeneral'), DATA.general);
  poblarSelect(document.getElementById('selControl'), DATA.control);
  poblarSelect(document.getElementById('selCiss'), DATA.ciss);
  poblarSelect(document.getElementById('selCliente'), DATA.clientes, c => c.id, c => c.nombre);
  const cli = DATA.clientes[0];
  poblarSelect(document.getElementById('selRepCliente'), cli.reportes);
  estado.seg = 'general';
  estado.rep = DATA.general[0].id;
  estado.cliente = DATA.clientes[0].id;
  activarSeg('general');
  isInitialized = true;
});
</script>
</body>
</html>
